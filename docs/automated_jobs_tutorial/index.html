<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-automated_jobs_tutorial">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.20">
<title data-rh="true">Automated Jobs Tutorial | OSU Sustainability Office Wiki</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://osu-sustainability-office.github.io//img/osu_so.png"><meta data-rh="true" name="twitter:image" content="https://osu-sustainability-office.github.io//img/osu_so.png"><meta data-rh="true" property="og:url" content="https://osu-sustainability-office.github.io//docs/automated_jobs_tutorial"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Automated Jobs Tutorial | OSU Sustainability Office Wiki"><meta data-rh="true" name="description" content="Guide on adding automated jobs"><meta data-rh="true" property="og:description" content="Guide on adding automated jobs"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://osu-sustainability-office.github.io//docs/automated_jobs_tutorial"><link data-rh="true" rel="alternate" href="https://osu-sustainability-office.github.io//docs/automated_jobs_tutorial" hreflang="en"><link data-rh="true" rel="alternate" href="https://osu-sustainability-office.github.io//docs/automated_jobs_tutorial" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.de1e84e6.css">
<link rel="preload" href="/assets/js/runtime~main.090bf6fb.js" as="script">
<link rel="preload" href="/assets/js/main.19388527.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_WrQt">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/favicon.ico" alt="My Site Logo" class="themedImage_YfMj themedImage--light_N9gV"><img src="/img/favicon.ico" alt="My Site Logo" class="themedImage_YfMj themedImage--dark_GvgL"></div><b class="navbar__title text--truncate">OSU SO Wiki</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/getting_started">Getting Started</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/faq">FAQ / HELP ME</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/specific">More Specific Documentation</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/tasks">Recurring Tasks</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/OSU-Sustainability-Office/osu-sustainability-office.github.io#contribution-guidelines" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Contribution Guidelines<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_mH2w"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_HVKm colorModeToggle_Ivz4"><button class="clean-btn toggleButton_dSuG toggleButtonDisabled_Jrgg" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_tjTj"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_YqhG"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_yQWO"><div class="navbar__search searchBarContainer_nwld"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_MTs2 searchBarLoadingRing_RHN6"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_yMUd"><kbd class="searchHint_CJly">ctrl</kbd><kbd class="searchHint_CJly">K</kbd></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_FZ7T"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_PKLg" type="button"></button><div class="docPage_v9RL"><aside class="theme-doc-sidebar-container docSidebarContainer_XUJ5"><div class="sidebar_lHCL"><nav class="menu thin-scrollbar menu_kesr"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/getting_started">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/frontend_prereqs">Frontend Prereqs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/backend_prereqs">Backend Prereqs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/faq">FAQ / HELP ME</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/specific">More Specific Documentation</a><button aria-label="Toggle the collapsible sidebar category &#x27;More Specific Documentation&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/database">Database</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/automated_jobs_tutorial">Automated Jobs Tutorial</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/energy_dashboard_graphs">Energy Dashboard Graph Logic</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lambda_common_layer">Lambda Common Layer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/carbon_calculator">Carbon Calculator</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/kiosks">Kiosks</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/tasks">Recurring Tasks</a><button aria-label="Toggle the collapsible sidebar category &#x27;Recurring Tasks&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_KAdh"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_S_Pg"><div class="docItemContainer_EWV1"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_AJsO" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_fY3m"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/specific"><span itemprop="name">More Specific Documentation</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Automated Jobs Tutorial</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_nzNI theme-doc-toc-mobile tocMobile_lrLv"><button type="button" class="clean-btn tocCollapsibleButton_WqQP">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Automated Jobs Tutorial</h1><h2 class="anchor anchorWithStickyNavbar_bOOd" id="general-info">General Info<a class="hash-link" href="#general-info" title="Direct link to heading">​</a></h2><p><a href="https://github.com/OSU-Sustainability-Office/automated-jobs" target="_blank" rel="noopener noreferrer">Link to GitHub Repository</a></p><h2 class="anchor anchorWithStickyNavbar_bOOd" id="automated-jobs-dev-setup">Automated-Jobs Dev Setup<a class="hash-link" href="#automated-jobs-dev-setup" title="Direct link to heading">​</a></h2><ol><li>From the repository root, cd into the folder of the automated job you want to run (e.g., SEC, check-acq).</li><li>Paste the env file into the corresponding automated job. <ul><li><a href="https://drive.google.com/drive/u/1/folders/1geuKCp-aTIrde2WdJkE3f_L2TsF46_O3" target="_blank" rel="noopener noreferrer">Link to .env files</a> (Need to be a paid OSU Sustainability Office Employee to see this link)</li><li>Env files that are used by automated jobs will have a file name like &quot;automated-jobs-XXXX.env.txt&quot; (e.g. automated-jobs-pacific.env.txt for the pacific power scraper). </li><li>Env files need <code>DASHBOARD_API = https://api.sustainability.oregonstate.edu/v2/energy</code> unless you are making changes to energy dashboard (more on this in Testing Pipeline section)</li></ul></li><li>Ensure you are using the correct node version. Node version could potentially vary between automated jobs so refer to the README.md in folder of the automated job.</li><li><code>npm i</code> to install packages.</li><li><code>node &lt;Javascript file name&gt;</code>, e.g. <code>node readsec.js</code> to run webscraper.</li></ol><h2 class="anchor anchorWithStickyNavbar_bOOd" id="aws-ecr-elastic-container-registry">AWS ECR (Elastic Container Registry)<a class="hash-link" href="#aws-ecr-elastic-container-registry" title="Direct link to heading">​</a></h2><p><a href="https://us-west-2.console.aws.amazon.com/ecr/repositories?region=us-west-2" target="_blank" rel="noopener noreferrer">AWS ECR</a> is the registry that stores and versions the Docker images for each automated job. Any update to a webscraper gets pushed to ECR as an image, and ECS automatically runs the newest image.</p><p><img loading="lazy" alt="alt_text" src="/assets/images/webscraper1-4711922623a2fe6a3cc92c93cef40b5d.png" title="image_tooltip" width="1496" height="664" class="img_LeO6"></p><h3 class="anchor anchorWithStickyNavbar_bOOd" id="creating-a-new-repository">Creating a new repository<a class="hash-link" href="#creating-a-new-repository" title="Direct link to heading">​</a></h3><p>This is only necessary if a new automated job has been developed.</p><ol><li>Click &quot;Create repository&quot;</li><li>In the &quot;General settings&quot; section, enter the repository name</li><li>Leave everything else as-is and click &quot;Create&quot;</li><li>Proceed to <a href="/docs/automated_jobs_tutorial#creating-a-new-task-definition">Creating a new task definition</a> section</li></ol><h3 class="anchor anchorWithStickyNavbar_bOOd" id="pushing-an-image-to-an-existing-repository">Pushing an image to an existing repository<a class="hash-link" href="#pushing-an-image-to-an-existing-repository" title="Direct link to heading">​</a></h3><p>Follow these steps when updating an existing automated job.</p><p><strong>Prerequisites</strong></p><ul><li>AWS CLI must be installed</li><li>Docker Desktop App must be running in background</li><li>For <strong>Windows Users</strong>:<ul><li>Windows PowerShell Admin<ul><li>If you are dealing with “execution of scripts is disabled on this system” issue, then <a href="https://stackoverflow.com/questions/54776324/powershell-bug-execution-of-scripts-is-disabled-on-this-system" target="_blank" rel="noopener noreferrer">this stack overflow article</a> may be useful.</li></ul></li><li>Install the specific module for managing ECR through the AWS Tools for PowerShell using: <code>Install-AWSToolsModule AWS.Tools.ECR</code></li></ul></li></ul><p><strong>Steps</strong></p><ol><li>From the <a href="https://us-west-2.console.aws.amazon.com/ecr/repositories?region=us-west-2" target="_blank" rel="noopener noreferrer">AWS ECR Private repositories list</a>, navigate to the desired automated job.</li><li>Click &quot;View push commands&quot;</li><li>Follow the AWS-provided push commands to authenticate, build, tag, and push your Docker image to the selected repository.</li></ol><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>Apple Silicon Macs require the <code>--platform linux/amd64</code> flag.</p></div></div><h2 class="anchor anchorWithStickyNavbar_bOOd" id="aws-ecs-elastic-container-service">AWS ECS (Elastic Container Service)<a class="hash-link" href="#aws-ecs-elastic-container-service" title="Direct link to heading">​</a></h2><p>AWS ECS is the service that runs the AWS ECR images as containers. ECS task definitions point to image URIs in ECR, so when you push an updated image to ECR, ECS can automatically pull and run the latest version.</p><h3 class="anchor anchorWithStickyNavbar_bOOd" id="creating-a-new-task-definition">Creating a new task definition<a class="hash-link" href="#creating-a-new-task-definition" title="Direct link to heading">​</a></h3><ol><li>From <a href="https://us-west-2.console.aws.amazon.com/ecs/v2/task-definitions?region=us-west-2" target="_blank" rel="noopener noreferrer">AWS ECS task definition page</a>, click on &quot;Create new task definition&quot; &gt; &quot;Create new task definition&quot; (not with JSON)</li><li>Check the box for &quot;AWS Fargate&quot; as the launch type</li><li>Leave Operating system/Architecture as-is</li><li>We can typically use cheapest option for cpu/memory (0.25 vCPU/0.5 GB)</li><li>In the Container details section, enter an appropriate container name.</li><li>For Image URI, click &quot;Browse ECR Images&quot; &gt; <em>Your automated job ECR</em> &gt; &quot;Use image tag: latest&quot;</li><li>In the logging section, enter the following values for each key:<div class="codeBlockContainer_tJhS theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_ZBU3"><pre tabindex="0" class="prism-code language-text codeBlock_IUSA thin-scrollbar"><code class="codeBlockLines_ObSK"><span class="token-line" style="color:#bfc7d5"><span class="token plain">- awslogs-group: /ecs/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- awslogs-region: us-west-2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- awslogs-stream-prefix: ecs</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- awslogs-create-group: true</span><br></span></code></pre><div class="buttonGroup_iqnp"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Q0PN" aria-hidden="true"><svg class="copyButtonIcon_gb_t" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_lMkQ" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol><p><strong>Note:</strong> If you are running into any issues, you can refer to an existing task definition&#x27;s JSON configuration settings.</p><h3 class="anchor anchorWithStickyNavbar_bOOd" id="creating-a-new-cluster">Creating a new cluster<a class="hash-link" href="#creating-a-new-cluster" title="Direct link to heading">​</a></h3><ol><li>From <a href="https://us-west-2.console.aws.amazon.com/ecs/v2/clusters?region=us-west-2" target="_blank" rel="noopener noreferrer">AWS ECS cluster page</a>, click &quot;Create cluster&quot;</li><li>Use default options and click &quot;Create&quot;</li><li>Go to the newly created cluster and click &quot;Scheduled tasks&quot;</li><li>Click update on an existing scheduled task for reference before making a new one (have them side by side on different tabs!)</li><li>While testing something for the first time, it&#x27;s a good idea to set the interval for running the CRON job as something like every minute or every 5 minutes. But once you are certain it works, make sure to turn the interval back to once every 24 hours or 48 hours etc.</li></ol><h2 class="anchor anchorWithStickyNavbar_bOOd" id="aws-cloudwatch">AWS Cloudwatch<a class="hash-link" href="#aws-cloudwatch" title="Direct link to heading">​</a></h2><p><a href="https://us-west-2.console.aws.amazon.com/cloudwatch/home?region=us-west-2#logsV2:log-groups" target="_blank" rel="noopener noreferrer">AWS Cloudwatch log groups</a> can be used for debugging purposes and to verify that the automated job has executed.</p><p>See <a href="/docs/cloudwatch">this page on Cloudwatch</a> as well for more information</p><h2 class="anchor anchorWithStickyNavbar_bOOd" id="testing-pipeline-guide">Testing Pipeline Guide<a class="hash-link" href="#testing-pipeline-guide" title="Direct link to heading">​</a></h2><p>Follow these steps in order to test your webscraper changes.</p><h3 class="anchor anchorWithStickyNavbar_bOOd" id="step-1-local-development-setup">Step 1: Local Development Setup<a class="hash-link" href="#step-1-local-development-setup" title="Direct link to heading">​</a></h3><p><strong>Prerequisites:</strong></p><ul><li>Ensure Node.js, Docker Desktop, and MySQL Workbench are installed</li><li>Have access credentials for the SQL database and Energy Dashboard API</li><li>Have the <code>.env</code> file for your automated job (e.g., <code>automated-jobs/SEC/.env</code>) (<a href="https://drive.google.com/drive/u/1/folders/1geuKCp-aTIrde2WdJkE3f_L2TsF46_O3" target="_blank" rel="noopener noreferrer">Link to .env files</a>)</li></ul><p><strong>Setup:</strong></p><ol><li>Navigate to your automated job folder (e.g., <code>automated-jobs/SEC/</code>)</li><li>Install dependencies: <code>npm install</code></li><li>Ensure you&#x27;re using the correct Node version (check the README.md in the folder)</li></ol><h3 class="anchor anchorWithStickyNavbar_bOOd" id="step-2-local-testing-nodejs">Step 2: Local Testing (Node.js)<a class="hash-link" href="#step-2-local-testing-nodejs" title="Direct link to heading">​</a></h3><p><strong>For webscraper-only changes:</strong></p><ol><li>Edit the <code>DASHBOARD_API</code> value in your <code>.env</code> file to use the production URL:<div class="codeBlockContainer_tJhS theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_ZBU3"><pre tabindex="0" class="prism-code language-text codeBlock_IUSA thin-scrollbar"><code class="codeBlockLines_ObSK"><span class="token-line" style="color:#bfc7d5"><span class="token plain">DASHBOARD_API = https://api.sustainability.oregonstate.edu/v2/energy</span><br></span></code></pre><div class="buttonGroup_iqnp"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Q0PN" aria-hidden="true"><svg class="copyButtonIcon_gb_t" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_lMkQ" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li>Run the webscraper: (e.g. <code>node readsec.js</code>)</li><li><strong>Success criteria:</strong> New data appears in the SQL database via MySQL Workbench</li></ol><p><strong>For changes involving energy dashboard backend:</strong></p><ol><li>Start the energy dashboard backend locally: <code>sam local start-api</code> (should run on http://localhost:3000)</li><li>Edit the <code>DASHBOARD_API</code> value in your <code>.env</code> file to use the local URL:<div class="codeBlockContainer_tJhS theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_ZBU3"><pre tabindex="0" class="prism-code language-text codeBlock_IUSA thin-scrollbar"><code class="codeBlockLines_ObSK"><span class="token-line" style="color:#bfc7d5"><span class="token plain">DASHBOARD_API = http://localhost:3000</span><br></span></code></pre><div class="buttonGroup_iqnp"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Q0PN" aria-hidden="true"><svg class="copyButtonIcon_gb_t" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_lMkQ" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li>Run the webscraper: (e.g. node readsec.js)</li><li><strong>Success criteria:</strong> <ul><li>New data appears in the SQL database</li><li>Local frontend shows the data (check via Inspect Element &gt; Network tab)</li></ul></li></ol><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><ul><li><code>API_PWD</code> in your automated-jobs env file should match the <code>AQUISUITE_PWD</code> value that the energy-dashboard backend expects</li><li>Reference these files for backend integration details:<ul><li><a href="https://github.com/OSU-Sustainability-Office/energy-dashboard/blob/master/backend/dependencies/nodejs/models/meter.js#L141" target="_blank" rel="noopener noreferrer">meter.js model</a></li><li><a href="https://github.com/OSU-Sustainability-Office/energy-dashboard/blob/master/backend/app/meter.js#L88" target="_blank" rel="noopener noreferrer">meter.js app</a></li></ul></li></ul></div></div><h3 class="anchor anchorWithStickyNavbar_bOOd" id="step-3-docker-testing">Step 3: Docker Testing<a class="hash-link" href="#step-3-docker-testing" title="Direct link to heading">​</a></h3><ol><li>Build the Docker image: <code>docker build . -t test</code></li></ol><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>Apple Silicon Macs require the <code>--platform linux/amd64</code> flag.</p></div></div><ol start="2"><li>Run the Docker container: <code>docker run -t test</code></li><li><strong>Success criteria:</strong> <ul><li>Container runs without errors</li><li>New data appears in the SQL database</li></ul></li></ol><h3 class="anchor anchorWithStickyNavbar_bOOd" id="step-4-aws-deployment-testing">Step 4: AWS Deployment Testing<a class="hash-link" href="#step-4-aws-deployment-testing" title="Direct link to heading">​</a></h3><p><strong>For webscraper updates only:</strong></p><ul><li>You only need to push changes to ECR (not ECS)</li><li>ECS should automatically pick up the latest ECR revision</li></ul><p><strong>Deployment steps:</strong></p><ol><li><a href="/docs/automated_jobs_tutorial#pushing-an-image-to-an-existing-repository">Push your Docker image to ECR</a></li><li>Temporarily change the ECS scheduled task interval to 1 minute for testing:<ul><li>Go to ECS &gt; cluster &gt; scheduled task &gt; update</li><li>Set interval to 1 minute</li></ul></li><li>Monitor the deployment via Cloudwatch logs</li><li><strong>Important!!</strong> Once you see the run in CloudWatch logs, revert the scheduled task to its original interval</li><li><strong>Success criteria:</strong><ul><li>Check Cloudwatch logs for successful execution</li><li>Verify data appears on production sites:<ul><li><a href="https://dashboard.sustainability.oregonstate.edu/#/building/30/2" target="_blank" rel="noopener noreferrer">SEC Solar</a></li><li><a href="https://dashboard.sustainability.oregonstate.edu/#/building/42/2" target="_blank" rel="noopener noreferrer">OSU Operations</a></li></ul></li><li>Confirm data in SQL database via MySQL Workbench</li></ul></li></ol><h3 class="anchor anchorWithStickyNavbar_bOOd" id="step-5-cleanup-and-final-verification">Step 5: Cleanup and Final Verification<a class="hash-link" href="#step-5-cleanup-and-final-verification" title="Direct link to heading">​</a></h3><ol><li><p><strong>Verify ECS interval:</strong> Confirm that the scheduled task has been reverted to its original interval</p></li><li><p><strong>Remove duplicate data:</strong> If testing created duplicate entries, clean them up:</p><div class="language-sql codeBlockContainer_tJhS theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_ZBU3"><pre tabindex="0" class="prism-code language-sql codeBlock_IUSA thin-scrollbar"><code class="codeBlockLines_ObSK"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">DELETE</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> Solar_Meters </span><span class="token keyword" style="font-style:italic">where</span><span class="token plain"> id </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token keyword" style="font-style:italic">some</span><span class="token plain"> id</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><br></span></code></pre><div class="buttonGroup_iqnp"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Q0PN" aria-hidden="true"><svg class="copyButtonIcon_gb_t" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_lMkQ" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>Redundant data is <a href="https://github.com/OSU-Sustainability-Office/energy-dashboard/pull/220/files#diff-6586f246008ae5ee333b803001847a4b4a69e2bbad28ff73b547375126b99a6bR80" target="_blank" rel="noopener noreferrer">handled on the frontend</a>, but it&#x27;s good practice to clean up</p></div></div></li><li><p><strong>Final verification:</strong> Confirm everything works in production</p></li></ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/OSU-Sustainability-Office/osu-sustainability-office.github.io/edit/main/website/docs/automated_jobs_tutorial.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_LtaH" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_PCor"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/database"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Database</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/energy_dashboard_graphs"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Energy Dashboard Graph Logic</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_gvVh thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#general-info" class="table-of-contents__link toc-highlight">General Info</a></li><li><a href="#automated-jobs-dev-setup" class="table-of-contents__link toc-highlight">Automated-Jobs Dev Setup</a></li><li><a href="#aws-ecr-elastic-container-registry" class="table-of-contents__link toc-highlight">AWS ECR (Elastic Container Registry)</a><ul><li><a href="#creating-a-new-repository" class="table-of-contents__link toc-highlight">Creating a new repository</a></li><li><a href="#pushing-an-image-to-an-existing-repository" class="table-of-contents__link toc-highlight">Pushing an image to an existing repository</a></li></ul></li><li><a href="#aws-ecs-elastic-container-service" class="table-of-contents__link toc-highlight">AWS ECS (Elastic Container Service)</a><ul><li><a href="#creating-a-new-task-definition" class="table-of-contents__link toc-highlight">Creating a new task definition</a></li><li><a href="#creating-a-new-cluster" class="table-of-contents__link toc-highlight">Creating a new cluster</a></li></ul></li><li><a href="#aws-cloudwatch" class="table-of-contents__link toc-highlight">AWS Cloudwatch</a></li><li><a href="#testing-pipeline-guide" class="table-of-contents__link toc-highlight">Testing Pipeline Guide</a><ul><li><a href="#step-1-local-development-setup" class="table-of-contents__link toc-highlight">Step 1: Local Development Setup</a></li><li><a href="#step-2-local-testing-nodejs" class="table-of-contents__link toc-highlight">Step 2: Local Testing (Node.js)</a></li><li><a href="#step-3-docker-testing" class="table-of-contents__link toc-highlight">Step 3: Docker Testing</a></li><li><a href="#step-4-aws-deployment-testing" class="table-of-contents__link toc-highlight">Step 4: AWS Deployment Testing</a></li><li><a href="#step-5-cleanup-and-final-verification" class="table-of-contents__link toc-highlight">Step 5: Cleanup and Final Verification</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Guides</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/getting_started">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/faq">FAQ / HELP ME</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/specific">More Specific Documentation</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tasks">Recurring Tasks</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/OSU-Sustainability-Office/osu-sustainability-office.github.io#contribution-guidelines" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contribution Guidelines<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_mH2w"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/OSU-Sustainability-Office/osu-sustainability-office.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_mH2w"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 OSU Sustainability Office. All rights reserved.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.090bf6fb.js"></script>
<script src="/assets/js/main.19388527.js"></script>
</body>
</html>